{% extends "blog_frame.html" %}
{% block scripts %}
<link href="/static/css/prism.css" rel="stylesheet" />
<script src="/static/js/prism.js"></script>
{% endblock %}
{% block content %}

<p>
    D3 is a well-known and -loved JavaScript data visualization and document object manipulation library which makes
    it possible to express even extremely complex visual ideas simply using an intuitive grammar. Jupyter is a
    browser-hosted Python executable environment which provides an intuitive data science interface.
</p>

<p>
    These libraries are foundational cornerstones of web-based data visualization and web-based data science,
    respectively, and most of my projects begin in one and end in another.
</p>

<p>
    However, they don't work together very well.
</p>

<p>
    The trouble is that whilst it's possible to run arbitrary JavaScript code inside of Jupyter Notebook cells (via
    the <code class="inline_code">%%javascript</code> or <code class="inline_code">%%html</code> cell magics),
    Jupyter places no restrictions on the elements of the page&mdash;the so-called document object model, or DOM
    for short&mdash;the executing code has access to.
</p>

<p>
    Since the Jupyter Notebook interface <i>itself</i> is a part of the page, this makes it extremely easy to
    accidentally do grievous harm to your environment. For instance, after importing D3 the following one-liner is
    sufficient to destroy your entire display:

<pre><code class="language-javascript">%%javascript d3.selectAll("div").remove();
</code></pre>

<p>
    Even subtle changes will have side-effects on your interface&mdash;not really tenable.
</p>

<p>
    This bothered me. I would do all of the data munging I needed for a project in the Notebook, then swap over to an
    entirely different environment&mdash;a JavaScript IDE&mdash;to prototype a full-scope visualization. Moving
    between interfaces like this slows work down and breaks the link between preparation and presentation which is
    integral to why Jupyter notebooks are so revolutionary in the first place.
</p>

<p>
    A few shims trying to address this problem already exist. I'm personally familiar with two: one a <a
        href="blog.thedataincubator.com/2015/08/embedding-d3-in-an-ipython-notebook/">hack</a> put together
    by folks at the Data Incubator (and it really is just that, a hack), the other a more polished API from <a
        href="https://github.com/stitchfix/d3-jupyter-tutorial/blob/master/PyData-D3-in-Jupyter.pdf">StitchFix</a>.
    Neither is really ideal: the former really is just a hack, while the latter requires some pretty complex template
    substitutions to work. It shouldn't have to be that hard.
</p>

<p>
    <code class="inline_code">py-d3</code> builds on these previous efforts by trying to provide a truly idempotent
    D3 environment. It achieves this by overwriting the default <code class="inline_code">d3.select()</code> and
    <code class="inline_code">d3.selectAll()</code> selector methods with cell-specific versions, ones that, at
    runtime, can only see objects created inside of the currently executed cell (an approach suggested to me by
    <a href="https://github.com/d3/d3/issues/2947">Mike Bostock</a> himself).
</p>

<p>
    All you have to do is declare <code class="inline_code">%%d3</code> at the top of your cell, and then everything
    shoud just work!
</p>

<p>
    These unlocks a wealth of complex visualizations that would be hard to do in Python alone. A <a
        href="http://bl.ocks.org/mbostock/4063550">radial Reingold-Tilford tree</a>, for example:
</p>

<img src="/static/post_assets/py-d3/radial-tree-example.png" class="inline_image_full" alt="Data."/>

<p>
    An <a href="http://bl.ocks.org/mbostock/4063582">interactive treemap</a>:
</p>

<img src="/static/post_assets/py-d3/tree-diagram-example.gif" class="inline_image_full" alt="Data."/>

<p>
    Or even the entire D3 <a href="https://bl.ocks.org/mbostock/1256572">show reel</a> animation:
</p>

<img src="/static/post_assets/py-d3/show-reel.gif" class="inline_image_full" alt="Data."/>

<p>
    It's important to remember that D3 is a high complexity, high fidelity approach to the problem. If you
    just need to get a point across or need to explore a data facet quickly, <a
        href="https://ipywidgets.readthedocs.io/en/latest/">ipywidgets</a> are an easier approach.
</p>

<p>
    But if you absolutely need full control&mdash;here's a new option to consider.
</p>

<p>
    Head over to the <a href="https://github.com/ResidentMario/py-d3">GitHub repository</a> to learn more.
</p>


{% endblock %}